# 18일차

### 보안그룹 vs NACL

| 보안 그룹 | NACL (Network Access Control List) |
| --- | --- |
| 인스턴스 레벨에 적용 (ENI와 연결) | 서브넷 레벨에 적용 |
| 허용 규칙만 지원 | 허용, 거부 규칙 지원 |
| 상태 저장 방화벽 (Stateful Firewall) | 상태 비저장 방화벽 (Stateless Firewall) |
| 트래픽 허용 여부를 결정하기 전에 모든 규칙을 평가 | 규칙 번호가 낮은 순서부터 규칙을 평가하여 트래픽을 허용 |
| 한 EC2 인스턴스 ENI → 5개 보안그룹에 연결 가능 | 한 NACL → 여러 서브넷과 연결 가능, 한 서브넷 → 한 NACL만 연결 가능 |
| 인스턴스에 직접 보안그룹을 지정&연결해서 적용 | 연결된 서브넷 내 모든 인스턴스에 자동 적용 |

> **상태 저장 방화벽**
아웃바운드 트래픽을 허용하면, 인바운드 트래픽은 체크하지 않고 그냥 허용
> 

> **상태 비저장 방화벽**
인바운드 트래픽에 대한 응답은 아웃바운드 트래픽 규칙에 따름, 아웃바운드 트래픽에 대한 응답은 인바운드 트래픽 규칙을 따름
> 

### NACL 규칙 번호

NACL에 여러 개의 허용 또는 거부 규칙을 지정할 수 있는데 각 규칙은 규칙 번호를 갖는다. 

NACL은 규칙 번호가 낮은 규칙부터 적용된다. 

예를 들어 HTTP 80번 포트를 거부하는 규칙의 규칙 번호가 90, 모든 TCP 포트를 허용하는 규칙의 규칙번호가 100 이라면, 90번 규칙이 먼저 적용되어 해당 서브넷에 존재하는 인스턴스에 80번 포트로 웹 접속을 할 수 없다.