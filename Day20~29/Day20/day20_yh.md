# 클린코드 20일차

## 13장 동시성 (2)

### 공유 객체 하나에는 메서드 하나만 사용하라

자바 언어는 개별 메서드를 보호하는 synchronized 개념을 지원하지만, 공유 클래스 하나에 동기화된 메서드가 여럿이라면 찾아내기 어려운 버그가 생길 수 있다. 

그럼에도 공유 객체 하나에 여러 메서드가 필요한 상황이 생긴다면 다음 3가지 방법을 고려하자.
1. 클라이언트에서 잠금
    - 클라이언트에서 첫번째 메서드를 호출하기 전에 서버를 잠근다. 마지막 메서드를 호출할 때까지 잠금을 유지한다.
2. 서버에서 잠금
    - 서버에다 "서버를 잠그고 모든 메서드를 호출한 후 잠금을 해제하는" 메서드를 구현한다. 클라이언트는 이 메서드를 호출한다.
3. 연결(Adapted) 서버
    - 잠금을 숭핸하는 중간 단계를 생성한다. '서버에서 잠금' 방식과 유사하지만 원래 서버는 변경하지 않는다. 

### 동기화하는 부분을 최대한 작게 만들어라

자바에서 synchronized 키워드로 락을 설정할 수 있고, **이렇게 설정된 코드 영역은 한번에 한 스레드만 실행이 가능**하다.
따라서 이렇게 동기화(synchronized)된 영역을 최소화하여 애플리케이션 성능에 무리가 가지 않도록 하자.
